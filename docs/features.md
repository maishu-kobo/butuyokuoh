# 機能一覧

## UIタブ構成

メインページは4タブ構成。管理機能は設定ページに集約。

| タブ | 説明 |
|------|------|
| リスト | メインのほしいものリスト |
| 出費予定 | 購入予定日別の合計金額 |
| 購入済 | 購入したアイテムの履歴 |
| 統計 | ダッシュボード |

### 設定ページ（⚙️アイコン）

- カテゴリ管理
- 比較グループ管理
- ゴミ箱
- 通知設定
- 認証トークン
- エクスポート
- テーマ設定（ダークモード）

---

## リストタブ

### 検索・フィルター（折りたたみ式）

デフォルトは折りたたまれた状態。クリックで展開。

- **テキスト検索**: 商品名、メモ、カテゴリ名で検索
- **ソート**: 優先度順 / 価格昇順・降順 / 新しい順・古い順 / 名前順
- **優先度フィルター**: 最高/高/普通/低/最低
- **カテゴリフィルター**: カテゴリボタンで絞り込み
- **比較グループフィルター**: グループ内のアイテムを絞り込み、最安表示
- **「適用中」バッジ**: フィルターが有効なときに表示

### ドラッグ＆ドロップ

アイテム左端のハンドル（☰）をドラッグして並び替え。

- **同一優先度内のみ**: 異なる優先度への移動は不可
- **楽観的更新**: ドロップ即座にUIに反映
- **sort_order保存**: ソート切り替え後も順序を維持

### 一括操作（選択モード）

「選択」ボタンで選択モードに切り替え。

- アイテムをタップして複数選択
- 「全選択」「選択解除」ボタン
- 一括操作:
  - 優先度変更
  - カテゴリ変更
  - 比較グループ変更
  - 購入済みにする
  - 削除

### アイテム追加

#### URLベース追加（通常）

1. URLを入力
2. 自動スクレイピングで商品情報取得
3. 優先度、購入予定日、カテゴリ等を設定

対応サイト:
- Amazon.co.jp / Amazon.com
- 楽天市場
- その他（OGP情報取得）

#### 手動追加

「手動で追加」リンクをクリックして切り替え。

- 商品名（必須）
- 価格
- URL（任意）
- 画像（URL入力またはアップロード）

### アイテムカード

各アイテムの表示内容:

- 商品画像
- 商品名
- 価格 × 個数 = 合計
- ソース（Amazon/楽天/その他）
- カテゴリタグ（色付き）
- 優先度バッジ（🔥最高 / ⭐高 / 普通 / 低 / 最低）
- 購入予定日
- 価格変動表示（前回価格との差分、↑↓矢印）

操作:
- 価格更新（再スクレイピング）
- 価格推移グラフ表示
- 編集
- 購入済みにする
- 削除（ゴミ箱へ）

### アイテム編集

編集可能な項目:

- 優先度 (1-5: 最高/高/普通/低/最低)
- 購入予定日
- 個数
- 目標価格（通知用、JPY/USD選択可）
- カテゴリ
- 比較グループ
- メモ
- 価格（手動）
- 画像（手動）

---

## 出費予定タブ

### 概要カード

- 全体の合計（個数考慮）
- 選択中の合計

### 月別表示

購入予定日が設定されたアイテムを月別にグループ化。

### 選択機能

- アイテムをクリックして選択/解除
- 月のチェックボックスで一括選択
- 「全て選択」「全て解除」ボタン
- 選択したアイテムの合計をリアルタイム表示

---

## 統計タブ

### 概要カード

- ほしいもの件数・合計
- 購入済み件数・合計
- 平均価格
- カテゴリ数

### 分析グラフ

- カテゴリ別（横棒グラフ）
- 優先度別
- サイト別（Amazon/楽天/その他）
- 価格帯分布（~¥1,000 / ¥1,000~¥5,000 / ...)
- 月別購入履歴（過去12ヶ月）

---

## 購入済みタブ

購入済みにしたアイテムの一覧。

- 購入日
- 購入価格
- リストに戻す操作

---

## ゴミ箱タブ

削除したアイテムの一覧。

- 復元
- 完全削除
- ゴミ箱を空にする

---

## 設定ページ

右上の⚙️アイコンからアクセス。各セクションは折りたたみ可能。

### カテゴリ管理

- カテゴリ作成（名前 + 色）
- カテゴリ名・色の編集
- カテゴリ削除（アイテムは削除されず「カテゴリなし」になる）
- 各カテゴリのアイテム数表示

### 比較グループ管理

似た商品をグループ化して比較。

- グループ作成
- グループ名編集
- グループ削除
- グループ内アイテム数表示

※ 商品の比較はリストページの「比較グループフィルター」で行う

### ゴミ箱

削除したアイテムの一覧。

- 復元
- 完全削除
- ゴミ箱を空にする

### 通知設定

- Slack Webhook URL
- Discord Webhook URL
- 価格下落時通知 ON/OFF
- 目標価格到達時通知 ON/OFF

### 認証トークン

Chrome拡張機能用のトークン。コピーボタンでクリップボードにコピー。

### エクスポート

CSVダウンロード（BOM付きUTF-8、Excel対応）：

- ほしいものリスト
- 購入済み
- すべて

### テーマ設定

- システム設定に従う（デフォルト）
- ライトモード
- ダークモード

---

## 価格通知

### 定期チェック

- 6時間ごとに全アイテムの価格を自動チェック
- JST 0:00, 6:00, 12:00, 18:00

### 通知内容

- 商品名
- 旧価格 → 新価格
- 値下げ率
- 商品ページへのリンク

---

## インポート

### Web版

「インポート」ボタンから公開設定のほしいものリストURLを入力。

### Chrome拡張機能

Amazon/楽天にログインした状態で、非公開リストもインポート可能。

#### セットアップ

1. 設定ページで認証トークンをコピー
2. 拡張機能でサーバーURLとトークンを設定
3. ほしいものリストページで拡張アイコンをクリック
4. 「インポート」をクリック

#### 商品ページから直接追加

Amazon/楽天の商品ページで拡張アイコンをクリックすると:

1. 商品情報（名前、価格、画像）が自動取得される
2. 優先度（最高/高/普通/低/最低）を選択
3. カテゴリを選択（任意）
4. 「物欲王に追加」をクリック

---

## PWA

### ホーム画面に追加

iPhone:
1. Safariでサイトを開く
2. 共有ボタンをタップ
3. 「ホーム画面に追加」を選択

Android:
1. Chromeでサイトを開く
2. メニューから「ホーム画面に追加」

### PWA設定

- アプリ名: 物欲王
- アイコン: 王冠
- テーマカラー: オレンジ
- 表示モード: standalone

---

## 認証

### メール/パスワード認証

- メールアドレスで新規登録
- パスワードは6文字以上
- JWTトークンベース

### Google SSO

NextAuth.js v5を使用。

設定が必要:
- Google Cloud ConsoleでOAuth 2.0クライアントを作成
- `.env.local`にGOOGLE_CLIENT_ID, GOOGLE_CLIENT_SECRETを設定

---

## モバイル対応

### スワイプでタブ切り替え

左右スワイプでタブが切り替わる。スライドアニメーション付き。

### コンパクト表示

- サマリーカード: 1行コンパクト表示
- タブ: 横スクロール対応

### ダークモード

システム設定に連動。設定ページで手動切り替えも可能。
